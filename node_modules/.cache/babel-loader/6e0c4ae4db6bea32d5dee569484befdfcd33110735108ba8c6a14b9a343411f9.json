{"ast":null,"code":"// src/Api.js\nconst API_URL = \"http://127.0.0.1:8000/api/\";\n\n// üîπ Cabe√ßalhos com token JWT\nexport function getAuthHeaders() {\n  const token = localStorage.getItem(\"access_token\");\n  return token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n}\n\n// üîπ LOGIN\nexport async function login(username, password) {\n  try {\n    const response = await fetch(`${API_URL}token/`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    });\n    if (!response.ok) return null;\n    const data = await response.json();\n    localStorage.setItem(\"access_token\", data.access);\n    localStorage.setItem(\"refresh_token\", data.refresh);\n    return data;\n  } catch (error) {\n    console.error(\"Erro ao fazer login:\", error);\n    return null;\n  }\n}\n\n// üîπ LOGOUT\nexport function logout() {\n  localStorage.removeItem(\"access_token\");\n  localStorage.removeItem(\"refresh_token\");\n}\n\n// üîπ REFRESH TOKEN\nexport async function refreshAccessToken() {\n  const refresh = localStorage.getItem(\"refresh_token\");\n  if (!refresh) return null;\n  const response = await fetch(`${API_URL}token/refresh/`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      refresh\n    })\n  });\n  if (!response.ok) {\n    logout();\n    return null;\n  }\n  const data = await response.json();\n  localStorage.setItem(\"access_token\", data.access);\n  return data.access;\n}\n\n// üîπ LIVROS\nexport async function getBooks() {\n  const response = await fetch(`${API_URL}books/`, {\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  return response.json();\n}\nexport async function saveBook(book) {\n  const method = book.id ? \"PUT\" : \"POST\";\n  const url = book.id ? `${API_URL}books/${book.id}/` : `${API_URL}books/`;\n  const response = await fetch(url, {\n    method,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(book)\n  });\n  if (!response.ok) throw new Error(\"Erro ao salvar livro\");\n  return response.json();\n}\nexport async function deleteBook(id) {\n  const response = await fetch(`${API_URL}books/${id}/`, {\n    method: \"DELETE\",\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  return response.ok;\n}\n\n// üîπ USU√ÅRIOS\nexport async function getUsers() {\n  const response = await fetch(`${API_URL}users/`, {\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  return response.json();\n}\n\n// üîπ EMPR√âSTIMOS\nexport async function getLoans() {\n  const response = await fetch(`${API_URL}loans/`, {\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  return response.json();\n}\n\n// üîπ USU√ÅRIO ATUAL\nexport async function getCurrentUser() {\n  const token = localStorage.getItem(\"access_token\");\n  if (!token) return null;\n  try {\n    const response = await fetch(`${API_URL}users/me/`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    if (!response.ok) return null;\n    return await response.json();\n  } catch (err) {\n    console.error(\"Erro ao obter usu√°rio atual:\", err);\n    return null;\n  }\n}","map":{"version":3,"names":["API_URL","getAuthHeaders","token","localStorage","getItem","Authorization","login","username","password","response","fetch","method","headers","body","JSON","stringify","ok","data","json","setItem","access","refresh","error","console","logout","removeItem","refreshAccessToken","getBooks","saveBook","book","id","url","Error","deleteBook","getUsers","getLoans","getCurrentUser","err"],"sources":["C:/Users/MARCIOJOSEDOSSANTOS/Desktop/biblioteca/frontend/src/Api.js"],"sourcesContent":["// src/Api.js\r\nconst API_URL = \"http://127.0.0.1:8000/api/\";\r\n\r\n// üîπ Cabe√ßalhos com token JWT\r\nexport function getAuthHeaders() {\r\n  const token = localStorage.getItem(\"access_token\");\r\n  return token ? { Authorization: `Bearer ${token}` } : {};\r\n}\r\n\r\n// üîπ LOGIN\r\nexport async function login(username, password) {\r\n  try {\r\n    const response = await fetch(`${API_URL}token/`, {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ username, password }),\r\n    });\r\n\r\n    if (!response.ok) return null;\r\n\r\n    const data = await response.json();\r\n    localStorage.setItem(\"access_token\", data.access);\r\n    localStorage.setItem(\"refresh_token\", data.refresh);\r\n\r\n    return data;\r\n  } catch (error) {\r\n    console.error(\"Erro ao fazer login:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\n// üîπ LOGOUT\r\nexport function logout() {\r\n  localStorage.removeItem(\"access_token\");\r\n  localStorage.removeItem(\"refresh_token\");\r\n}\r\n\r\n// üîπ REFRESH TOKEN\r\nexport async function refreshAccessToken() {\r\n  const refresh = localStorage.getItem(\"refresh_token\");\r\n  if (!refresh) return null;\r\n\r\n  const response = await fetch(`${API_URL}token/refresh/`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ refresh }),\r\n  });\r\n\r\n  if (!response.ok) {\r\n    logout();\r\n    return null;\r\n  }\r\n\r\n  const data = await response.json();\r\n  localStorage.setItem(\"access_token\", data.access);\r\n  return data.access;\r\n}\r\n\r\n// üîπ LIVROS\r\nexport async function getBooks() {\r\n  const response = await fetch(`${API_URL}books/`, {\r\n    headers: { ...getAuthHeaders() },\r\n  });\r\n  return response.json();\r\n}\r\n\r\nexport async function saveBook(book) {\r\n  const method = book.id ? \"PUT\" : \"POST\";\r\n  const url = book.id ? `${API_URL}books/${book.id}/` : `${API_URL}books/`;\r\n\r\n  const response = await fetch(url, {\r\n    method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify(book),\r\n  });\r\n\r\n  if (!response.ok) throw new Error(\"Erro ao salvar livro\");\r\n  return response.json();\r\n}\r\n\r\nexport async function deleteBook(id) {\r\n  const response = await fetch(`${API_URL}books/${id}/`, {\r\n    method: \"DELETE\",\r\n    headers: { ...getAuthHeaders() },\r\n  });\r\n  return response.ok;\r\n}\r\n\r\n// üîπ USU√ÅRIOS\r\nexport async function getUsers() {\r\n  const response = await fetch(`${API_URL}users/`, {\r\n    headers: { ...getAuthHeaders() },\r\n  });\r\n  return response.json();\r\n}\r\n\r\n// üîπ EMPR√âSTIMOS\r\nexport async function getLoans() {\r\n  const response = await fetch(`${API_URL}loans/`, {\r\n    headers: { ...getAuthHeaders() },\r\n  });\r\n  return response.json();\r\n}\r\n\r\n// üîπ USU√ÅRIO ATUAL\r\nexport async function getCurrentUser() {\r\n  const token = localStorage.getItem(\"access_token\");\r\n  if (!token) return null;\r\n\r\n  try {\r\n    const response = await fetch(`${API_URL}users/me/`, {\r\n      headers: { Authorization: `Bearer ${token}` },\r\n    });\r\n\r\n    if (!response.ok) return null;\r\n\r\n    return await response.json();\r\n  } catch (err) {\r\n    console.error(\"Erro ao obter usu√°rio atual:\", err);\r\n    return null;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}