{"ast":null,"code":"// src/ApiService.js\nconst API_URL = \"http://127.0.0.1:8000/api/\";\n\n/* ===============================\r\n   üîπ Autentica√ß√£o JWT\r\n   =============================== */\nexport async function login(username, password) {\n  const res = await fetch(`${API_URL}token/`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  });\n  if (!res.ok) throw new Error(\"Erro ao autenticar.\");\n  const data = await res.json();\n  localStorage.setItem(\"access_token\", data.access);\n  localStorage.setItem(\"refresh_token\", data.refresh);\n  return data;\n}\nexport function logout() {\n  localStorage.removeItem(\"access_token\");\n  localStorage.removeItem(\"refresh_token\");\n}\nexport async function refreshToken() {\n  const refresh = localStorage.getItem(\"refresh_token\");\n  if (!refresh) return null;\n  try {\n    const res = await fetch(`${API_URL}token/refresh/`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        refresh\n      })\n    });\n    if (!res.ok) throw new Error(\"Falha ao renovar token\");\n    const data = await res.json();\n    localStorage.setItem(\"access_token\", data.access);\n    return data.access;\n  } catch (err) {\n    console.error(\"Erro ao renovar token:\", err);\n    logout();\n    return null;\n  }\n}\nfunction getAuthHeaders() {\n  const token = localStorage.getItem(\"access_token\");\n  return token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n}\n\n/* ===============================\r\n   üìö Livros\r\n   =============================== */\nexport async function getBooks() {\n  const res = await fetch(`${API_URL}books/`, {\n    headers: getAuthHeaders()\n  });\n  if (!res.ok) throw new Error(\"Erro ao buscar livros.\");\n  return await res.json();\n}\nexport async function createBook(bookData) {\n  const res = await fetch(`${API_URL}books/`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(bookData)\n  });\n  if (!res.ok) throw new Error(\"Erro ao criar livro.\");\n  return await res.json();\n}\nexport async function updateBook(id, bookData) {\n  const res = await fetch(`${API_URL}books/${id}/`, {\n    method: \"PUT\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(bookData)\n  });\n  if (!res.ok) throw new Error(\"Erro ao atualizar livro.\");\n  return await res.json();\n}\nexport async function deleteBook(id) {\n  const res = await fetch(`${API_URL}books/${id}/`, {\n    method: \"DELETE\",\n    headers: getAuthHeaders()\n  });\n  if (!res.ok) throw new Error(\"Erro ao excluir livro.\");\n}\n\n/* ===============================\r\n   üë§ Usu√°rios\r\n   =============================== */\nexport async function getUsers() {\n  const res = await fetch(`${API_URL}users/`, {\n    headers: getAuthHeaders()\n  });\n  if (!res.ok) throw new Error(\"Erro ao buscar usu√°rios.\");\n  return await res.json();\n}\nexport async function createUser(userData) {\n  const res = await fetch(`${API_URL}users/`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(userData)\n  });\n  if (!res.ok) throw new Error(\"Erro ao criar usu√°rio.\");\n  return await res.json();\n}\n\n/* ===============================\r\n   üîÅ Empr√©stimos\r\n   =============================== */\nexport async function getLoans() {\n  const res = await fetch(`${API_URL}loans/`, {\n    headers: getAuthHeaders()\n  });\n  if (!res.ok) throw new Error(\"Erro ao buscar empr√©stimos.\");\n  return await res.json();\n}\nexport async function createLoan(loanData) {\n  const res = await fetch(`${API_URL}loans/`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(loanData)\n  });\n  if (!res.ok) throw new Error(\"Erro ao registrar empr√©stimo.\");\n  return await res.json();\n}\nexport async function returnLoan(id) {\n  const res = await fetch(`${API_URL}loans/${id}/return/`, {\n    method: \"POST\",\n    headers: getAuthHeaders()\n  });\n  if (!res.ok) throw new Error(\"Erro ao devolver livro.\");\n  return await res.json();\n}\n\n/* ===============================\r\n   üë§ Usu√°rio Atual\r\n   =============================== */\nexport async function getCurrentUser() {\n  const res = await fetch(`${API_URL}me/`, {\n    headers: getAuthHeaders()\n  });\n  if (!res.ok) throw new Error(\"Erro ao obter usu√°rio atual.\");\n  return await res.json();\n}","map":{"version":3,"names":["API_URL","login","username","password","res","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","localStorage","setItem","access","refresh","logout","removeItem","refreshToken","getItem","err","console","error","getAuthHeaders","token","Authorization","getBooks","createBook","bookData","updateBook","id","deleteBook","getUsers","createUser","userData","getLoans","createLoan","loanData","returnLoan","getCurrentUser"],"sources":["C:/Users/MARCIOJOSEDOSSANTOS/Desktop/biblioteca/frontend/src/services/api.js"],"sourcesContent":["// src/ApiService.js\r\nconst API_URL = \"http://127.0.0.1:8000/api/\";\r\n\r\n/* ===============================\r\n   üîπ Autentica√ß√£o JWT\r\n   =============================== */\r\nexport async function login(username, password) {\r\n  const res = await fetch(`${API_URL}token/`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ username, password }),\r\n  });\r\n\r\n  if (!res.ok) throw new Error(\"Erro ao autenticar.\");\r\n  const data = await res.json();\r\n\r\n  localStorage.setItem(\"access_token\", data.access);\r\n  localStorage.setItem(\"refresh_token\", data.refresh);\r\n\r\n  return data;\r\n}\r\n\r\nexport function logout() {\r\n  localStorage.removeItem(\"access_token\");\r\n  localStorage.removeItem(\"refresh_token\");\r\n}\r\n\r\nexport async function refreshToken() {\r\n  const refresh = localStorage.getItem(\"refresh_token\");\r\n  if (!refresh) return null;\r\n\r\n  try {\r\n    const res = await fetch(`${API_URL}token/refresh/`, {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ refresh }),\r\n    });\r\n\r\n    if (!res.ok) throw new Error(\"Falha ao renovar token\");\r\n\r\n    const data = await res.json();\r\n    localStorage.setItem(\"access_token\", data.access);\r\n    return data.access;\r\n  } catch (err) {\r\n    console.error(\"Erro ao renovar token:\", err);\r\n    logout();\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction getAuthHeaders() {\r\n  const token = localStorage.getItem(\"access_token\");\r\n  return token ? { Authorization: `Bearer ${token}` } : {};\r\n}\r\n\r\n/* ===============================\r\n   üìö Livros\r\n   =============================== */\r\nexport async function getBooks() {\r\n  const res = await fetch(`${API_URL}books/`, { headers: getAuthHeaders() });\r\n  if (!res.ok) throw new Error(\"Erro ao buscar livros.\");\r\n  return await res.json();\r\n}\r\n\r\nexport async function createBook(bookData) {\r\n  const res = await fetch(`${API_URL}books/`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\", ...getAuthHeaders() },\r\n    body: JSON.stringify(bookData),\r\n  });\r\n  if (!res.ok) throw new Error(\"Erro ao criar livro.\");\r\n  return await res.json();\r\n}\r\n\r\nexport async function updateBook(id, bookData) {\r\n  const res = await fetch(`${API_URL}books/${id}/`, {\r\n    method: \"PUT\",\r\n    headers: { \"Content-Type\": \"application/json\", ...getAuthHeaders() },\r\n    body: JSON.stringify(bookData),\r\n  });\r\n  if (!res.ok) throw new Error(\"Erro ao atualizar livro.\");\r\n  return await res.json();\r\n}\r\n\r\nexport async function deleteBook(id) {\r\n  const res = await fetch(`${API_URL}books/${id}/`, {\r\n    method: \"DELETE\",\r\n    headers: getAuthHeaders(),\r\n  });\r\n  if (!res.ok) throw new Error(\"Erro ao excluir livro.\");\r\n}\r\n\r\n/* ===============================\r\n   üë§ Usu√°rios\r\n   =============================== */\r\nexport async function getUsers() {\r\n  const res = await fetch(`${API_URL}users/`, { headers: getAuthHeaders() });\r\n  if (!res.ok) throw new Error(\"Erro ao buscar usu√°rios.\");\r\n  return await res.json();\r\n}\r\n\r\nexport async function createUser(userData) {\r\n  const res = await fetch(`${API_URL}users/`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\", ...getAuthHeaders() },\r\n    body: JSON.stringify(userData),\r\n  });\r\n  if (!res.ok) throw new Error(\"Erro ao criar usu√°rio.\");\r\n  return await res.json();\r\n}\r\n\r\n/* ===============================\r\n   üîÅ Empr√©stimos\r\n   =============================== */\r\nexport async function getLoans() {\r\n  const res = await fetch(`${API_URL}loans/`, { headers: getAuthHeaders() });\r\n  if (!res.ok) throw new Error(\"Erro ao buscar empr√©stimos.\");\r\n  return await res.json();\r\n}\r\n\r\nexport async function createLoan(loanData) {\r\n  const res = await fetch(`${API_URL}loans/`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\", ...getAuthHeaders() },\r\n    body: JSON.stringify(loanData),\r\n  });\r\n  if (!res.ok) throw new Error(\"Erro ao registrar empr√©stimo.\");\r\n  return await res.json();\r\n}\r\n\r\nexport async function returnLoan(id) {\r\n  const res = await fetch(`${API_URL}loans/${id}/return/`, {\r\n    method: \"POST\",\r\n    headers: getAuthHeaders(),\r\n  });\r\n  if (!res.ok) throw new Error(\"Erro ao devolver livro.\");\r\n  return await res.json();\r\n}\r\n\r\n/* ===============================\r\n   üë§ Usu√°rio Atual\r\n   =============================== */\r\nexport async function getCurrentUser() {\r\n  const res = await fetch(`${API_URL}me/`, { headers: getAuthHeaders() });\r\n  if (!res.ok) throw new Error(\"Erro ao obter usu√°rio atual.\");\r\n  return await res.json();\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}