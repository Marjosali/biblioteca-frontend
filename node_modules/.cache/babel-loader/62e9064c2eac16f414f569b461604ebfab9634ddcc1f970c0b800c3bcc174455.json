{"ast":null,"code":"// src/Api.js\nconst API_URL = \"http://127.0.0.1:8000/api/\";\n\n/**\r\n * ðŸ”¹ FunÃ§Ã£o auxiliar para incluir o token JWT nas requisiÃ§Ãµes\r\n */\nfunction getAuthHeaders() {\n  const token = localStorage.getItem(\"access_token\");\n  return token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n}\n\n/**\r\n * ðŸ”¹ Login do usuÃ¡rio â€” obtÃ©m e salva tokens JWT\r\n */\nexport async function login(username, password) {\n  const response = await fetch(`${API_URL}token/`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  });\n  if (!response.ok) {\n    console.error(\"Erro ao autenticar:\", response.status);\n    throw new Error(\"UsuÃ¡rio ou senha incorretos\");\n  }\n  const data = await response.json();\n\n  // âœ… Armazena os tokens JWT localmente\n  localStorage.setItem(\"access_token\", data.access);\n  localStorage.setItem(\"refresh_token\", data.refresh);\n  console.log(\"ðŸ”‘ Tokens salvos com sucesso!\");\n  return data;\n}\n\n/**\r\n * ðŸ”¹ Logout â€” limpa os tokens salvos\r\n */\nexport function logout() {\n  localStorage.removeItem(\"access_token\");\n  localStorage.removeItem(\"refresh_token\");\n}\n\n/**\r\n * ðŸ”¹ ObtÃ©m o usuÃ¡rio autenticado (dados do token)\r\n */\nexport async function getCurrentUser() {\n  const headers = getAuthHeaders();\n  const response = await fetch(`${API_URL}users/me/`, {\n    headers\n  });\n  if (response.status === 401) {\n    console.warn(\"UsuÃ¡rio nÃ£o autenticado (token invÃ¡lido ou expirado).\");\n    return null;\n  }\n  if (!response.ok) {\n    console.error(\"Erro ao obter usuÃ¡rio:\", response.status);\n    throw new Error(\"Erro ao buscar o usuÃ¡rio atual\");\n  }\n  const data = await response.json();\n  console.log(\"ðŸ‘¤ UsuÃ¡rio atual:\", data);\n  return data;\n}\n\n/**\r\n * ðŸ”¹ Exemplo â€” lista de usuÃ¡rios (rota administrativa)\r\n */\nexport async function getUsers() {\n  const headers = getAuthHeaders();\n  const response = await fetch(`${API_URL}users/`, {\n    headers\n  });\n  if (!response.ok) {\n    console.error(\"Erro ao buscar usuÃ¡rios:\", response.status);\n    throw new Error(\"Falha ao carregar lista de usuÃ¡rios\");\n  }\n  return response.json();\n}\n\n/**\r\n * ðŸ”¹ Exemplo â€” lista de livros\r\n */\nexport async function getBooks() {\n  const response = await fetch(`${API_URL}books/`);\n  if (!response.ok) throw new Error(\"Erro ao buscar livros\");\n  return response.json();\n}","map":{"version":3,"names":["API_URL","getAuthHeaders","token","localStorage","getItem","Authorization","login","username","password","response","fetch","method","headers","body","JSON","stringify","ok","console","error","status","Error","data","json","setItem","access","refresh","log","logout","removeItem","getCurrentUser","warn","getUsers","getBooks"],"sources":["C:/Users/MARCIOJOSEDOSSANTOS/Desktop/biblioteca/frontend/src/Api.js"],"sourcesContent":["// src/Api.js\r\nconst API_URL = \"http://127.0.0.1:8000/api/\";\r\n\r\n/**\r\n * ðŸ”¹ FunÃ§Ã£o auxiliar para incluir o token JWT nas requisiÃ§Ãµes\r\n */\r\nfunction getAuthHeaders() {\r\n  const token = localStorage.getItem(\"access_token\");\r\n  return token ? { Authorization: `Bearer ${token}` } : {};\r\n}\r\n\r\n/**\r\n * ðŸ”¹ Login do usuÃ¡rio â€” obtÃ©m e salva tokens JWT\r\n */\r\nexport async function login(username, password) {\r\n  const response = await fetch(`${API_URL}token/`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ username, password }),\r\n  });\r\n\r\n  if (!response.ok) {\r\n    console.error(\"Erro ao autenticar:\", response.status);\r\n    throw new Error(\"UsuÃ¡rio ou senha incorretos\");\r\n  }\r\n\r\n  const data = await response.json();\r\n\r\n  // âœ… Armazena os tokens JWT localmente\r\n  localStorage.setItem(\"access_token\", data.access);\r\n  localStorage.setItem(\"refresh_token\", data.refresh);\r\n\r\n  console.log(\"ðŸ”‘ Tokens salvos com sucesso!\");\r\n  return data;\r\n}\r\n\r\n/**\r\n * ðŸ”¹ Logout â€” limpa os tokens salvos\r\n */\r\nexport function logout() {\r\n  localStorage.removeItem(\"access_token\");\r\n  localStorage.removeItem(\"refresh_token\");\r\n}\r\n\r\n/**\r\n * ðŸ”¹ ObtÃ©m o usuÃ¡rio autenticado (dados do token)\r\n */\r\nexport async function getCurrentUser() {\r\n  const headers = getAuthHeaders();\r\n  const response = await fetch(`${API_URL}users/me/`, { headers });\r\n\r\n  if (response.status === 401) {\r\n    console.warn(\"UsuÃ¡rio nÃ£o autenticado (token invÃ¡lido ou expirado).\");\r\n    return null;\r\n  }\r\n\r\n  if (!response.ok) {\r\n    console.error(\"Erro ao obter usuÃ¡rio:\", response.status);\r\n    throw new Error(\"Erro ao buscar o usuÃ¡rio atual\");\r\n  }\r\n\r\n  const data = await response.json();\r\n  console.log(\"ðŸ‘¤ UsuÃ¡rio atual:\", data);\r\n  return data;\r\n}\r\n\r\n/**\r\n * ðŸ”¹ Exemplo â€” lista de usuÃ¡rios (rota administrativa)\r\n */\r\nexport async function getUsers() {\r\n  const headers = getAuthHeaders();\r\n  const response = await fetch(`${API_URL}users/`, { headers });\r\n\r\n  if (!response.ok) {\r\n    console.error(\"Erro ao buscar usuÃ¡rios:\", response.status);\r\n    throw new Error(\"Falha ao carregar lista de usuÃ¡rios\");\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * ðŸ”¹ Exemplo â€” lista de livros\r\n */\r\nexport async function getBooks() {\r\n  const response = await fetch(`${API_URL}books/`);\r\n  if (!response.ok) throw new Error(\"Erro ao buscar livros\");\r\n  return response.json();\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}